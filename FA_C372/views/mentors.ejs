<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EduSphere | Mentors</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@300..800&family=Space+Grotesk:wght@400..700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/styles/style.css" />
  </head>
  <body class="mentor-page">
    <%- include("partials/navbar") %>
    <main class="section mentor-section">
      <div class="container">
        <header class="mentor-hero mb-4">
          <div>
            <p class="eyebrow text-uppercase text-muted mb-1">Mentor spotlight</p>
            <h1 class="display-5 fw-bold">Meet the educators guiding the catalog</h1>
            <p class="text-muted lead">
              Browse verified lecturers, explore their courses, and connect with mentors who match
              your learning path.
            </p>
          </div>
          <div class="mentor-hero-card">
            <p class="text-muted small mb-1">Active mentors</p>
            <strong class="display-6"><%= lecturers.length %></strong>
            <p class="text-muted small mb-0">
              <%= Object.keys(coursesByInstructor).reduce((count, key) => count + coursesByInstructor[key].length, 0) %>
              courses published
            </p>
          </div>
        </header>

        <section class="row g-4">
          <% if (lecturers.length === 0) { %>
            <div class="col-12">
              <div class="alert alert-info text-center">
                No mentors registered yet. Reach out to admins to onboard new lecturers.
              </div>
            </div>
          <% } %>

          <% lecturers.forEach(function(lect) { %>
            <% const courses = coursesByInstructor[lect.id] || []; %>
            <% const stats = statsByInstructor[lect.id] || { avg_rating: "0.0", review_count: 0 }; %>
            <article class="col-12 col-md-6">
              <div class="card mentor-card h-100 shadow-sm">
                <div class="card-body d-flex flex-column">
                  <div class="d-flex justify-content-between align-items-start mb-3">
                    <div>
                      <h3 class="h5 mb-1"><%= lect.name %></h3>
                      <p class="text-muted small mb-0"><%= lect.email %></p>
                    </div>
                    <span class="badge bg-light text-dark small mentor-badge">
                      <%= lect.created_at ? new Date(lect.created_at).getFullYear() : "New" %> mentor
                    </span>
                  </div>
                  <div class="mentor-stats d-flex gap-3 mb-3">
                    <div>
                      <strong><%= stats.avg_rating %>★</strong>
                      <p class="text-muted small mb-0">Average rating</p>
                    </div>
                    <div>
                      <strong><%= stats.review_count %></strong>
                      <p class="text-muted small mb-0">Reviews</p>
                    </div>
                    <div>
                      <strong><%= courses.length %></strong>
                      <p class="text-muted small mb-0">Courses</p>
                    </div>
                  </div>
                  <p class="text-muted small mb-2">
                    Featured courses
                    <span class="text-dark fw-semibold">
                      (<%= courses.length ? Math.min(courses.length, 3) : 0 %>)
                    </span>
                  </p>
                  <% if (courses.length === 0) { %>
                    <div class="empty-state small">No public courses yet.</div>
                  <% } else { %>
                    <ul class="list-unstyled mentor-course-list mb-3">
                      <% courses.slice(0, 3).forEach(function(course) { %>
                        <li>
                          <strong><%= course.course_name %></strong>
                          <span class="text-muted small d-block">
                            <%= course.category || "General" %> · $<%= Number(course.price).toFixed(2) %>
                          </span>
                        </li>
                      <% }); %>
                    </ul>
                  <% } %>
                  <div class="mt-auto d-flex gap-2 flex-wrap">
                    <a class="btn btn-outline-primary btn-sm" href="/courses?mentor=<%= lect.id %>">
                      View all courses
                    </a>
                    <button class="btn btn-gradient btn-sm">Book a call</button>
                  </div>
                </div>
              </div>
            </article>
          <% }); %>
        </section>
      </div>
    </main>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
      <%- include("partials/footer") %>
  </body>
</html>
