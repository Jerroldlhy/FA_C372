<header class="site-header">
  <div class="container header-inner">
    <a class="brand" href="/">
      <span class="brand-dot"></span>
      <span>EduSphere</span>
    </a>
    <% 
      const safeRole = currentUser?.role ? String(currentUser.role).toLowerCase() : null;
      const dashboardPath =
        safeRole === "admin"
          ? "/dashboard/admin"
          : safeRole === "lecturer"
          ? "/dashboard/lecturer"
          : "/dashboard/student";
      const dashboardLabel =
        safeRole === "admin"
          ? "Admin Dashboard"
          : safeRole === "lecturer"
          ? "Lecturer Dashboard"
          : "Student Dashboard";
      const navItems = [
        { label: "Mentors", href: "/mentors" },
        { label: "Plans", href: "/plans" }
      ];
      if (safeRole !== "admin" && safeRole !== "lecturer") {
        navItems.unshift({ label: "Courses", href: "/courses" });
      }
      if (safeRole === "admin") {
        navItems.push({ label: "Refunds", href: "/admin/refunds" });
      }
      if (safeRole === "student") {
        navItems.push({ label: "My Learning", href: "/learning" });
        navItems.push({ label: "Wallet", href: "/wallet" });
        navItems.push({ label: "Cart", href: "/cart" });
      }
      if (safeRole) {
        navItems.push({ label: "Security / 2FA", href: "/2fa/setup" });
      }
    %>
    <div class="header-middle">
      <nav class="nav-links">
        <% navItems.forEach(function(item) { %>
          <a href="<%= item.href %>"><%= item.label %></a>
        <% }); %>
      </nav>
    </div>
    <div class="header-actions">
      <% if (currentUser) { %>
        <div class="user-pill">
          <div class="user-pill-meta">
            <strong><%= currentUser.name || "Member" %></strong>
            <div class="user-pill-role text-muted small text-uppercase">
              <%= currentUser.role %>
            </div>
          </div>
          <div class="user-pill-actions">
            <a class="user-pill-dashboard" href="<%= dashboardPath %>">
              <%= dashboardLabel %>
            </a>
            <form method="POST" action="/logout">
              <button class="user-pill-signout" type="submit">
                Sign Out
              </button>
            </form>
          </div>
        </div>
      <% } else { %>
        <a class="text-link" href="/login">Log In</a>
        <a class="btn btn-primary" href="/signup">Sign Up</a>
      <% } %>
    </div>
  </div>
</header>
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>
<script src="/scripts/tom-select-init.js"></script>
